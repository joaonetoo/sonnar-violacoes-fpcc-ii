"0","proporcao_func <- function(d,subtipo, i) {"
"0","    resultado = d %>% "
"0","        slice(i) %>%"
"0","        group_by(violation, violation_subtype) %>% "
"0","        summarise("
"0","        soma_por_subtipo = sum(count),"
"0","        .groups =""drop"")  %>% arrange(desc(soma_por_subtipo), .by_group = TRUE) %>% "
"0","        mutate(proporcao_por_subtipo =  (soma_por_subtipo/sum(soma_por_subtipo))*100) %>% "
"0","        filter(violation_subtype == subtipo)"
"0","    proporcao = resultado %>% pull(proporcao_por_subtipo)"
"0","    proporcao"
"0","}"
"0",""
