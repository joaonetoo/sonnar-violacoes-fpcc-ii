mutate(violacao_proporcao =  (soma/sum(soma))*100)
proporcao_cs = resultado %>% filter("code_smells") %>% pull(violacao_proporcao)
proporcao_bd = resultado %>% filter("bad_practices") %>% pull(violacao_proporcao)
proporcao_bd - proporcao_cs
}
violacoes_ic = calcula_ci(dados, 'NA',  violacao_proporcao_func)
calcula_ci <- function(d, subtipo, FUN=funcao) {
booted <- boot(data = d,
subtipo = subtipo,
statistic = FUN,
R = 1000)
ci = tidy(booted,
conf.level = .95,
conf.method = "basic",
conf.int = TRUE)
ci
}
violacoes_ic = calcula_ci(dados, 'NA',  violacao_proporcao_func)
calcula_ci <- function(d, subtipo = "NA", FUN=funcao) {
booted <- boot(data = d,
subtipo = subtipo,
statistic = FUN,
R = 1000)
ci = tidy(booted,
conf.level = .95,
conf.method = "basic",
conf.int = TRUE)
ci
}
violacoes_ic = calcula_ci(dados, 'NA',  violacao_proporcao_func)
violacao_proporcao_func <- function(d, i) {
resultado = d %>%
slice(i) %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop")  %>% arrange(desc(soma), .by_group = TRUE) %>%
mutate(violacao_proporcao =  (soma/sum(soma))*100)
proporcao_cs = resultado %>% filter("code_smells") %>% pull(violacao_proporcao)
proporcao_bd = resultado %>% filter("bad_practices") %>% pull(violacao_proporcao)
proporcao_bd - proporcao_cs
}
booted <- boot(data = d,
statistic = violacao_proporcao_func,
R = 1000)
violacao_proporcao_func <- function(d, i) {
resultado = d %>%
slice(i) %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop")  %>% arrange(desc(soma), .by_group = TRUE) %>%
mutate(violacao_proporcao =  (soma/sum(soma))*100)
proporcao_cs = resultado %>% filter("code_smells") %>% pull(violacao_proporcao)
proporcao_bd = resultado %>% filter("bad_practices") %>% pull(violacao_proporcao)
proporcao_bd - proporcao_cs
}
booted <- boot(data = dados,
statistic = violacao_proporcao_func,
R = 1000)
violacao_proporcao_func <- function(d, i) {
resultado = d %>%
slice(i) %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop")  %>% arrange(desc(soma), .by_group = TRUE) %>%
mutate(violacao_proporcao =  (soma/sum(soma))*100)
proporcao_cs = resultado %>% filter(violation == "code_smells") %>% pull(violacao_proporcao)
proporcao_bd = resultado %>% filter(violation =="bad_practices") %>% pull(violacao_proporcao)
proporcao_bd - proporcao_cs
}
booted <- boot(data = dados,
statistic = violacao_proporcao_func,
R = 1000)
violacoes_ic = tidy(booted,
conf.level = .95,
conf.method = "basic",
conf.int = TRUE)
violacoes_ic
dados %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop")  %>% arrange(desc(soma), .by_group = TRUE) %>%
mutate(violacao_proporcao =  (soma/sum(soma))*100)
View(bad_practices)
View(dados)
View(code_smells)
code_smells <- read_csv("data/code_smells.csv")
View(code_smells)
bad_practices <- read_csv("data/bad_practices.csv")
View(bad_practices)
library(tidyverse)
code_smells <- read_csv("data/code_smells.csv")
bad_practices <- read_csv("data/bad_practices.csv")
code_smells <- code_smells %>% gather(violation_subtype, count, -c(name))
bad_practices <- bad_practices %>% gather(violation_subtype, count, -c(name))
violacoes_concatenadas = bind_rows(
`code_smells` = code_smells,
`bad_practices` = bad_practices,
.id = "violation"
)
violacoes_concatenadas %>%
write_csv(here::here("data/violacoes.csv"))
View(bad_practices)
View(dados)
View(bad_practices)
View(bad_practices)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(hrbrthemes)
library(boot)
library(broom)
library(gridExtra)
library(ggplot2)
library(plot3D)
library(FactoMineR)
library(factoextra)
library(pscl)
library(tidymodels)
library(modelr)
library(tidyr)
library(forcats)
theme_set(theme_ipsum_rc())
dados <- read_csv("../data/violacoes.csv")
dados
dados %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop") %>%  ungroup() %>% arrange(desc(soma), .by_group = TRUE)
violacoes = dados %>%
group_by(violation, violation_subtype) %>%
summarise(
soma_por_subtipo = sum(count),
.groups ="drop")  %>% arrange(desc(soma_por_subtipo), .by_group = TRUE) %>%
mutate(proporcao_por_subtipo = if_else(violation == "code_smells", (soma_por_subtipo/sum(soma_por_subtipo[violation == "code_smells"]))*100
,(soma_por_subtipo/sum(soma_por_subtipo[violation == "bad_practices"]))*100))
violacoes
violacoes %>%
filter(violation == "code_smells") %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
ggsave("figura-1.pdf") # ggsave salva o que foi plotado por Ãºltimo
ggsave("figura-1.pdf", width = 6, height = 4)
violacoes %>%
filter(violation == "code_smells") %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.8, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
violacoes %>%
filter(violation == "code_smells") %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.9, width=.4) +
coord_flip() +
xlab("") +
theme_bw()
violacoes %>%
filter(violation == "code_smells") %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.9, width=.4) +
coord_flip() +
xlab("") +
ylab("Porcentagem (%)") +
theme_bw()
ggsave("figura-1.pdf", width = 6, height = 4)
violacoes %>%
filter(violation == "bad_practices") %>%
mutate(violation_subtype =  str_trunc(violation_subtype, 20, "right")) %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.9, width=.4) +
coord_flip() +
labs(x = "", y = "Porcentagem (%)") +
theme_bw()
violacoes %>%
filter(violation == "bad_practices") %>%
mutate(violation_subtype =  str_trunc(violation_subtype, 10, "right")) %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.9, width=.4) +
coord_flip() +
labs(x = "", y = "Porcentagem (%)") +
theme_bw()
violacoes %>%
filter(violation == "bad_practices") %>%
mutate(violation_subtype =  str_trunc(violation_subtype, 13, "right")) %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.9, width=.4) +
coord_flip() +
labs(x = "", y = "Porcentagem (%)") +
theme_bw()
ggsave("figura-2.pdf", width = 6, height = 4)
dados_code_smells_ic = dados %>%
filter(violation == "code_smells")
calcula_ci <- function(d, subtipo = "NA", FUN=funcao) {
booted <- boot(data = d,
subtipo = subtipo,
statistic = FUN,
R = 2000)
ci = tidy(booted,
conf.level = .95,
conf.method = "basic",
conf.int = TRUE)
ci
}
proporcao_func <- function(d,subtipo, i) {
resultado = d %>%
slice(i) %>%
group_by(violation, violation_subtype) %>%
summarise(
soma_por_subtipo = sum(count),
.groups ="drop")  %>% arrange(desc(soma_por_subtipo), .by_group = TRUE) %>%
mutate(proporcao_por_subtipo =  (soma_por_subtipo/sum(soma_por_subtipo))*100) %>%
filter(violation_subtype == subtipo)
proporcao = resultado %>% pull(proporcao_por_subtipo)
proporcao
}
subtipos_code_smells = violacoes %>%
filter(violation == "code_smells", proporcao_por_subtipo > 3) %>%
group_by(violation_subtype) %>%
summarise(ic = calcula_ci(dados_code_smells_ic, violation_subtype, proporcao_func), .groups = "drop")
subtipos_code_smells %>%
ggplot(aes(
xmin = ic$conf.low,
x = ic$statistic,
xmax = ic$conf.high,
y = violation_subtype
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "")
ggsave("figura-3.pdf", width = 6, height = 4)
subtipos_code_smells %>%
ggplot(aes(
xmin = ic$conf.low,
x = ic$statistic,
xmax = ic$conf.high,
y = violation_subtype
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
subtipos_code_smells %>%
ggplot(aes(
xmin = ic$conf.low,
x = ic$statistic,
xmax = ic$conf.high,
y = violation_subtype
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "", y = "") +
theme_bw()
ggsave("figura-3.pdf", width = 6, height = 4)
dados_bad_practices_ic = dados %>%
filter(violation == "bad_practices")
subtipos_bad_practices = violacoes %>%
filter(violation == "bad_practices", proporcao_por_subtipo > 3) %>%
group_by(violation_subtype) %>%
summarise(ic = calcula_ci(dados_bad_practices_ic, violation_subtype, proporcao_func), .groups = "drop")
subtipos_bad_practices %>%
ggplot(aes(
xmin = ic$conf.low,
x = ic$statistic,
xmax = ic$conf.high,
y = violation_subtype
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "")
subtipos_bad_practices %>%
ggplot(aes(
xmin = ic$conf.low,
x = ic$statistic,
xmax = ic$conf.high,
y = violation_subtype
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
ggsave("figura-4.pdf", width = 6, height = 4)
violacao_proporcao_func <- function(d, i) {
resultado = d %>%
slice(i) %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop")  %>% arrange(desc(soma), .by_group = TRUE) %>%
mutate(violacao_proporcao =  (soma/sum(soma))*100)
proporcao_cs = resultado %>% filter(violation == "code_smells") %>% pull(violacao_proporcao)
proporcao_bd = resultado %>% filter(violation =="bad_practices") %>% pull(violacao_proporcao)
proporcao_bd - proporcao_cs
}
booted <- boot(data = dados,
statistic = violacao_proporcao_func,
R = 1000)
violacoes_ic = tidy(booted,
conf.level = .95,
conf.method = "basic",
conf.int = TRUE)
violacao_proporcao_func <- function(d, i) {
resultado = d %>%
slice(i) %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop")  %>% arrange(desc(soma), .by_group = TRUE) %>%
mutate(violacao_proporcao =  (soma/sum(soma))*100)
proporcao_cs = resultado %>% filter(violation == "code_smells") %>% pull(violacao_proporcao)
proporcao_bd = resultado %>% filter(violation =="bad_practices") %>% pull(violacao_proporcao)
proporcao_bd - proporcao_cs
}
booted <- boot(data = dados,
statistic = violacao_proporcao_func,
R = 2000)
violacoes_ic = tidy(booted,
conf.level = .95,
conf.method = "basic",
conf.int = TRUE)
violacoes %>%
filter(violation == "code_smells") %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.9, width=.4) +
coord_flip() +
xlab("") +
ylab("Porcentagem (%)") +
theme_bw()
ggsave("figura-1.pdf", width = 4, height = 3)
ggsave("figura-1.pdf", width = 4, height = 2)
violacoes %>%
filter(violation == "code_smells") %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.9, width=.4) +
coord_flip() +
xlab("") +
ylab("%") +
theme_bw()
ggsave("figura-1.pdf", width = 4, height = 2)
ggsave("figura-1.pdf", width = 5, height = 3)
ggsave("figura-1.pdf", width = 5, height = 2)
ggsave("figura-1.pdf", width = 6, height = 2)
ggsave("figura-1.pdf", width = 6, height = 2)
ggsave("figura-1.pdf", width = 6, height = 3)
```{r}
violacoes %>%
filter(violation == "code_smells)
violacoes %>%
filter(violation == "code_smells")
violacoes %>%
filter(violation == "bad_practices")
violacoes %>%
filter(violation == "bad_practices") %>%
mutate(violation_subtype =  str_trunc(violation_subtype, 13, "right")) %>%
mutate(violation_subtype = fct_reorder(violation_subtype, proporcao_por_subtipo)) %>%
ggplot( aes(x=violation_subtype, y=proporcao_por_subtipo)) +
geom_bar(stat="identity", fill="#f68060", alpha=.9, width=.4) +
coord_flip() +
labs(x = "", y = "%") +
theme_bw()
ggsave("figura-2.pdf", width = 6, height = 4)
ggsave("figura-3.pdf", width = 6, height = 4)
subtipos_code_smells %>%
ggplot(aes(
xmin = ic$conf.low,
x = ic$statistic,
xmax = ic$conf.high,
y = violation_subtype
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "", y = "") +
theme_bw()
ggsave("figura-4.pdf", width = 6, height = 3)
dados_bad_practices_ic = dados %>%
filter(violation == "bad_practices")
subtipos_bad_practices %>%
ggplot(aes(
xmin = ic$conf.low,
x = ic$statistic,
xmax = ic$conf.high,
y = violation_subtype
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
ggsave("figura-5.pdf", width = 6, height = 3)
dados %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop")  %>% arrange(desc(soma), .by_group = TRUE) %>%
mutate(violacao_proporcao =  (soma/sum(soma))*100)
violacao_proporcao_func <- function(d, i) {
resultado = d %>%
slice(i) %>%
group_by(violation) %>%
summarise(
soma = sum(count),
.groups ="drop")  %>% arrange(desc(soma), .by_group = TRUE) %>%
mutate(violacao_proporcao =  (soma/sum(soma))*100)
proporcao_cs = resultado %>% filter(violation == "code_smells") %>% pull(violacao_proporcao)
proporcao_bd = resultado %>% filter(violation =="bad_practices") %>% pull(violacao_proporcao)
proporcao_bd - proporcao_cs
}
booted <- boot(data = dados,
statistic = violacao_proporcao_func,
R = 2000)
violacoes_ic = tidy(booted,
conf.level = .95,
conf.method = "basic",
conf.int = TRUE)
violacoes_ic %>%
ggplot(aes(
ymin = conf.low,
y = statistic,
ymax = conf.high
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
violacoes_ic %>%
ggplot(aes(
ymin = conf.low,
y = statistic,
x="",
ymax = conf.high
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
violacoes_ic %>%
ggplot(aes(
xmin = conf.low,
x = statistic,
y="",
xmax = conf.high
)) +
geom_linerange() +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
violacoes_ic %>%
ggplot(aes(
xmin = conf.low,
x = statistic,
y="",
xmax = conf.high
)) +
geom_linerange() +
scale_y_continuous(limits = c(30, 100)) +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
violacoes_ic %>%
ggplot(aes(
xmin = conf.low,
x = statistic,
y="",
xmax = conf.high
)) +
geom_linerange() +
scale_x_continuous(limits = c(30, 100)) +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
violacoes_ic %>%
ggplot(aes(
xmin = conf.low,
x = statistic,
y="",
xmax = conf.high
)) +
geom_linerange() +
scale_x_continuous(limits = c(40, 100)) +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
violacoes_ic %>%
ggplot(aes(
xmin = conf.low,
x = statistic,
y="",
xmax = conf.high
)) +
geom_linerange() +
scale_x_continuous(limits = c(30, 100)) +
geom_point(color = "brown", size = 2) +
labs(x = "%", y = "") +
theme_bw()
ggsave("figura-6.pdf", width = 6, height = 3)
ggsave("figura-6.pdf", width = 4, height = 3)
ggsave("figura-6.pdf", width = 4, height = 3)
ggsave("figura-6.pdf", width = 4, height = 2)
